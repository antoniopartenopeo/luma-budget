# Audit UI 360 - Numa Budget

Data audit: 2026-02-22  
Perimetro: intera app UI (`/`, `/transactions`, `/transactions/import`, `/insights`, `/simulator`, `/settings`, `/updates`, `/brain`)  
Baseline: working tree attuale (inclusi file non committati)  
Modalita: diagnostica read-only (nessuna modifica logica business)  
Metodo: analisi statica + verifica runtime con screenshot desktop/tablet/mobile

Governance di riferimento:
- `.agent/rules/ui-regression-checklist.md`
- `.agent/skills/numa-ui-standards/SKILL.md`
- `docs/governance/MOTION_PRINCIPLES.md`

## 1) Executive Summary UI

Il sistema visivo risulta globalmente coerente su materiali, radius e struttura macro-card, ma presenta debito significativo su quattro assi:

1. Motion non uniforme tra route e componenti (orchestrazione non omogenea e layering multiplo).
2. Drift cromatico su chart con hardcoded `#hex` e tooltip inline-style, fuori token system.
3. Fragilita responsive in `settings` su viewport mobile (tab label troncata).
4. Residui UI obsoleti/morti (componenti non referenziati e copy semanticamente in ritardo).

Valutazione sintetica:
- Stato complessivo UI: **parzialmente conforme**
- Rischio principale: **coerenza motion + accessibilita motion-reduced**
- Rischio secondario: **drift semantico e manutentivita visuale su chart/copy**

## 2) Matrice Route x Coerenza UI

Legenda: `OK` coerente, `PARZ` parzialmente coerente, `KO` incoerente

| Route | Motion ingressi | Colori/Materiali | Tipografia | Responsive | Evidenze statiche | Evidenze runtime |
|---|---|---|---|---|---|---|
| `/` | PARZ | PARZ | PARZ | OK | `src/app/page.tsx:32`, `src/features/dashboard/components/kpi-cards.tsx:216`, `src/components/patterns/kpi-card.tsx:74` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/home.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/home.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/home.png` |
| `/transactions` | OK | OK | PARZ | OK | `src/app/transactions/page.tsx:141` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/transactions.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/transactions.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/transactions.png` |
| `/transactions/import` | PARZ | PARZ | PARZ | OK | `src/app/transactions/import/page.tsx:14`, `src/components/patterns/numa-engine-card.tsx:63` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/transactions-import.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/transactions-import.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/transactions-import.png` |
| `/insights` | PARZ | KO | PARZ | OK | `src/features/insights/components/insights-page-content.tsx:48`, `src/features/insights/components/trend-analysis-card.tsx:344`, `src/features/insights/components/trend-analysis-card.tsx:387` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/insights.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/insights.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/insights.png` |
| `/simulator` | OK | PARZ | PARZ | OK | `src/app/simulator/page.tsx:31`, `src/components/patterns/numa-engine-card.tsx:63` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/simulator.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/simulator.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/simulator.png` |
| `/settings` | KO | OK | PARZ | KO | `src/app/settings/page.tsx:93`, `src/app/settings/page.tsx:43` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/settings.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/settings.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/settings.png` |
| `/updates` | KO | OK | PARZ | OK | `src/app/updates/page.tsx:4`, `src/features/notifications/components/updates-page-content.tsx:44` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/updates.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/updates.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/updates.png` |
| `/brain` | OK | PARZ | KO | PARZ | `src/app/brain/page.tsx:680`, `src/app/brain/page.tsx:746`, `src/app/brain/page.tsx:877` | `docs/audit/artifacts/ui-360-2026-02-22/desktop/brain.png`, `docs/audit/artifacts/ui-360-2026-02-22/tablet/brain.png`, `docs/audit/artifacts/ui-360-2026-02-22/mobile/brain.png` |

## 3) Tabella Finding Completa

| ID | Tipo | Gravita | Impatto roadmap | Problema | Evidenze | Fatto osservato | Inferenza |
|---|---|---|---|---|---|---|---|
| F-UI-001 | Motion Inconsistency | High | Alto | Orchestrazione ingresso non uniforme tra route core | `src/app/settings/page.tsx:93`, `src/app/transactions/import/page.tsx:14`, `src/app/updates/page.tsx:4`; runtime: `.../desktop/settings.png`, `.../desktop/transactions-import.png`, `.../desktop/updates.png` | Alcune route usano `StaggerContainer` globale, altre no | Esperienza di ingresso percepita come discontinua tra sezioni |
| F-UI-002 | Motion Inconsistency | High | Alto | Layering motion concorrente (container + macro + card) | `src/components/patterns/macro-section.tsx:51`, `src/features/dashboard/components/kpi-cards.tsx:216`, `src/components/patterns/kpi-card.tsx:74`, `src/features/insights/components/ai-advisor-card.tsx:206` | Stesso blocco visuale puo essere animato da 2-3 livelli diversi | Timing/ritmo non prevedibile e divergenza tra card simili |
| F-UI-003 | Fragility | High | Alto | `prefers-reduced-motion` non copre le animazioni Framer non gate-izzate | `src/app/globals.css:253`, `src/components/patterns/kpi-card.tsx:74`, `src/features/insights/components/ai-advisor-card.tsx:206`, `src/features/insights/components/insight-card.tsx:94` | Riduzione motion e implementata in CSS primitives, non sulle animazioni Framer locali | Parte delle transizioni resta attiva anche con preferenza riduzione movimento |
| F-UI-004 | Fragility | Medium | Medio | Transizioni su proprieta layout (`max-height`/`height:auto`) in UI interattiva | `src/components/layout/topbar.tsx:79`, `src/components/patterns/expandable-card.tsx:155` | Menu quick-add mobile e card espandibili dipendono da animazioni layout | Possibili micro-stutter/reflow su device meno performanti |
| F-UI-005 | Color/Material Drift | High | Alto | Drift cromatico forte su chart Insights (hex hardcoded + tooltip inline HTML style) | `src/features/insights/components/trend-analysis-card.tsx:344`, `src/features/insights/components/trend-analysis-card.tsx:387`, `src/features/insights/components/trend-analysis-card.tsx:447` | Colori/typo tooltip non derivano da token design system | Coerenza tema e mantenibilita visuale degradano nel tempo |
| F-UI-006 | Color/Material Drift | Medium | Medio | Palette fallback chart con colore `indigo` hardcoded | `src/features/dashboard/components/charts/spending-composition-card.tsx:155` | Fallback palette include `#4f46e5` | Rischio drift rispetto alla governance colore primaria |
| F-UI-007 | Color/Material Drift | Medium | Medio | Palette categorie con slot `indigo/purple` statici | `src/features/categories/components/category-form-sheet.tsx:19`, `src/features/categories/components/category-form-sheet.tsx:22` | Selettore colore categoria espone colori non allineati al modello visivo corrente | Linguaggio cromatico non pienamente omogeneo tra sezioni |
| F-UI-008 | Color/Material Drift | Medium | Medio | Macro-surface pattern non omogeneo (`glass-card` dove governance privilegia macro `glass-panel`) | `src/components/patterns/numa-engine-card.tsx:63` vs `src/components/patterns/macro-section.tsx:61` | Due primitive macro diverse coesistono come superfici principali | Profondita/materialita percepite cambiano tra sezioni equivalenti |
| F-UI-009 | Typography Drift | Medium | Medio | Proliferazione micro-font (`text-[9px]`, `text-[10px]`, `text-[11px]`) in aree dense | `src/features/notifications/components/topbar-notifications.tsx:134`, `src/features/notifications/components/topbar-notifications.tsx:184`, `src/app/brain/page.tsx:746`, `src/app/brain/page.tsx:885` | Label meta e badge molto compressi su piu componenti | Leggibilita marginale su viewport piccoli e aumento carico cognitivo |
| F-UI-010 | Responsive Drift | High | Alto | Troncamento label tab su mobile in `settings` | statico: `src/app/settings/page.tsx:43`, `src/app/settings/page.tsx:44`; runtime: `docs/audit/artifacts/ui-360-2026-02-22/mobile/settings.png` | In mobile la label "Preferenze" appare troncata (`'referenze`) | Comportamento responsive non robusto nei tab principali |
| F-UI-011 | Obsolete String | Medium | Medio | Messaggistica update ancora orientata a fase beta | `src/features/notifications/components/updates-page-content.tsx:44`, `src/features/notifications/components/topbar-notifications.tsx:51`, `src/features/notifications/components/topbar-notifications.tsx:75` | UI usa "beta tester" e "Aggiornamenti Beta" | Posizionamento comunicativo non allineato a una narrativa product stabile |
| F-UI-012 | Semantic Drift | Low | Basso | Mix linguistico nella navigazione e label tecniche | `src/components/layout/sidebar.tsx:21`, `src/components/layout/sidebar.tsx:22`, `src/app/settings/page.tsx:58` | Italiano/inglese convivono in nav primaria e tab | Tono editoriale percepito come non uniforme |
| F-UI-013 | Dead UI Code | Medium | Medio | Componente timeline abbonamenti non referenziato | `src/components/patterns/subscription-timeline-card.tsx:27`; nessun import consumer trovato in `src/` | Il file esiste ma non e agganciato a nessun flusso UI | Costo manutentivo passivo e debito semantico nel design inventory |
| F-UI-014 | Dead UI Code | Medium | Medio | Barrel review esporta componenti non usati (`ReviewAdvice`, `ImportMetricsGrid`) | `src/features/import-csv/components/review/index.ts:3`, `src/features/import-csv/components/review/index.ts:6`, `src/features/import-csv/components/step-review.tsx:25` | Import effettivo usa solo 2 componenti del barrel | Residui di iterazioni precedenti nel modulo import |
| F-UI-015 | Semantic Drift | Low | Basso | Firma helper UI con parametro inattivo | `src/features/goals/utils/financial-lab-copy.ts:82` | `_realtimeWindowMonths` non influisce sul risultato | Interfaccia copy suggerisce variabilita non realmente presente |

## 4) Codice Morto UI

1. `src/components/patterns/subscription-timeline-card.tsx:27`
- Stato: componente esportato ma non referenziato in app.
- Tipo: `Dead UI Code`
- Impatto: inventario UI gonfiato e segnali progettuali ambigui.

2. `src/features/import-csv/components/review/review-advice.tsx:14`
- Stato: componente presente ma nessun consumer runtime.
- Tipo: `Dead UI Code`
- Impatto: debito di manutenzione nel modulo review CSV.

3. `src/features/import-csv/components/review/import-metrics-grid.tsx:28`
- Stato: componente presente ma non agganciato a flussi attivi.
- Tipo: `Dead UI Code`
- Impatto: superficie UI non piu rappresentativa del comportamento reale.

4. `src/features/import-csv/components/review/index.ts:3`
5. `src/features/import-csv/components/review/index.ts:6`
- Stato: re-export non utilizzati dal consumer principale (`src/features/import-csv/components/step-review.tsx:25`).
- Tipo: `Dead UI Code`
- Impatto: API modulo piu ampia del necessario.

## 5) Stringhe Obsolete / Semantic Drift

1. `src/features/notifications/components/updates-page-content.tsx:44`
- Stringa: "...fix distribuiti ai beta tester."
- Classificazione: `Obsolete String` (gravita Medium).

2. `src/features/notifications/components/topbar-notifications.tsx:51`
- Stringa ARIA: "Notifiche changelog beta"
- Classificazione: `Obsolete String` (gravita Medium).

3. `src/features/notifications/components/topbar-notifications.tsx:75`
- Stringa UI: "Aggiornamenti Beta"
- Classificazione: `Obsolete String` (gravita Medium).

4. `src/components/layout/sidebar.tsx:22`, `src/app/settings/page.tsx:58`
- Stringhe: "Financial Lab", "Avanzate (Tech)"
- Classificazione: `Semantic Drift` (gravita Low).

5. `src/features/goals/utils/financial-lab-copy.ts:82`
- Segnale: parametro `_realtimeWindowMonths` inutilizzato.
- Classificazione: `Semantic Drift` (gravita Low).

## 6) Motion Audit Dedicato

### 6.1 Ingressi route

- Route con orchestrazione motion esplicita (`StaggerContainer`):
  - `src/app/transactions/page.tsx:141`
  - `src/app/simulator/page.tsx:31`
  - `src/app/brain/page.tsx:680`
  - `src/features/insights/components/insights-page-content.tsx:48`

- Route senza orchestrazione omogenea a livello pagina:
  - `src/app/settings/page.tsx:93`
  - `src/app/transactions/import/page.tsx:14`
  - `src/app/updates/page.tsx:4`

### 6.2 Layering motion

- `MacroSection` applica motion strutturale di default (`src/components/patterns/macro-section.tsx:51`).
- `KpiCard` applica un ulteriore `motion.div` (`src/components/patterns/kpi-card.tsx:74`).
- `DashboardKpiGrid` aggiunge wrapper `StaggerContainer` + `motion.div` per ogni card (`src/features/dashboard/components/kpi-cards.tsx:216`).
- `AIAdvisorCard` aggiunge un proprio container staggered (`src/features/insights/components/ai-advisor-card.tsx:206`).

### 6.3 Reduced motion

- Presidio globale esiste solo su classi CSS primitive (`src/app/globals.css:253`).
- Le animazioni Framer locali non sono uniformemente condizionate da `useReducedMotion`:
  - `src/components/patterns/kpi-card.tsx:74`
  - `src/features/insights/components/ai-advisor-card.tsx:206`
  - `src/features/insights/components/insight-card.tsx:94`

### 6.4 Motion su proprieta layout

- Topbar mobile quick-add usa `max-height` dinamico (`src/components/layout/topbar.tsx:79`).
- Expandable card usa animazione `height: auto` (`src/components/patterns/expandable-card.tsx:156`).

## 7) Color & Material Audit Dedicato

1. Drift token in Insights chart:
- `src/features/insights/components/trend-analysis-card.tsx:344`
- `src/features/insights/components/trend-analysis-card.tsx:389`
- `src/features/insights/components/trend-analysis-card.tsx:447`

2. Palette hardcoded su composizione spese:
- `src/features/dashboard/components/charts/spending-composition-card.tsx:154`
- `src/features/dashboard/components/charts/spending-composition-card.tsx:155`

3. Palette categorie con indigo/purple/violet statici:
- `src/features/categories/components/category-form-sheet.tsx:19`
- `src/features/categories/components/category-form-sheet.tsx:22`

4. Materialita macro non unificata:
- `NumaEngineCard`: `glass-card` (`src/components/patterns/numa-engine-card.tsx:63`)
- `MacroSection`: `glass-panel` (`src/components/patterns/macro-section.tsx:61`)

## 8) Typography Audit Dedicato

1. Micro-typography intensa in topbar notifiche:
- `src/features/notifications/components/topbar-notifications.tsx:134`
- `src/features/notifications/components/topbar-notifications.tsx:167`
- `src/features/notifications/components/topbar-notifications.tsx:184`

2. Micro-label intensa in brain page:
- `src/app/brain/page.tsx:746`
- `src/app/brain/page.tsx:877`
- `src/app/brain/page.tsx:885`

3. Uso esteso di `text-[...]` custom su aree core (evidenza aggregata):
- Brain, Notifications, Insight cards (campionamento statico su codebase UI).

4. Evidenza runtime di densita tipografica mobile:
- `docs/audit/artifacts/ui-360-2026-02-22/mobile/brain.png`
- `docs/audit/artifacts/ui-360-2026-02-22/mobile/updates.png`

## 9) Rischi 6-12 Mesi (Se Non Si Interviene)

1. **Erosione coerenza percepita del brand UI** (motion/material non uniformi).
- Probabilita: alta
- Effetto: frammentazione dell'esperienza tra sezioni core.

2. **Debito accessibilita motion** (preferenze riduzione movimento non coperte su tutta la catena Framer).
- Probabilita: medio-alta
- Effetto: peggioramento comfort d'uso per utenti sensibili al movimento.

3. **Aumento costo manutentivo visuale** (hardcoded color/tooltip HTML inline).
- Probabilita: alta
- Effetto: regressioni cromatiche piu frequenti nei prossimi cambi tema/palette.

4. **Drift responsive cumulativo** (esempio gia visibile su tab `settings` mobile).
- Probabilita: alta
- Effetto: regressioni progressive su viewport piccoli/tablet in nuove iterazioni.

5. **Debito semantico e inventario UI non pulito** (dead components + copy legacy).
- Probabilita: alta
- Effetto: onboard piu lento, review UI meno affidabile, ambiguita nel linguaggio prodotto.

## 10) Appendice Evidenze

### 10.1 Artifact runtime

Percorso root: `docs/audit/artifacts/ui-360-2026-02-22/`

Desktop (`1440x900`):
- `desktop/home.png`
- `desktop/transactions.png`
- `desktop/transactions-import.png`
- `desktop/insights.png`
- `desktop/simulator.png`
- `desktop/settings.png`
- `desktop/updates.png`
- `desktop/brain.png`

Tablet (`1024x1366`):
- `tablet/home.png`
- `tablet/transactions.png`
- `tablet/transactions-import.png`
- `tablet/insights.png`
- `tablet/simulator.png`
- `tablet/settings.png`
- `tablet/updates.png`
- `tablet/brain.png`

Mobile (`390x844`):
- `mobile/home.png`
- `mobile/transactions.png`
- `mobile/transactions-import.png`
- `mobile/insights.png`
- `mobile/simulator.png`
- `mobile/settings.png`
- `mobile/updates.png`
- `mobile/brain.png`

### 10.2 Comandi runtime usati

- Cattura screenshot Playwright con attesa deterministica (`--wait-for-timeout=3500`)
- Browser: Chromium
- Nessuna modifica a file applicativi (`src/` invariato)

### 10.3 Nota metodologica

Le conclusioni sono separate in:
- **Fatto osservato**: evidenza statica e/o runtime misurabile
- **Inferenza**: rischio o impatto prevedibile sulla roadmap UI

Nessuna proposta di refactor/fix inclusa in questo documento.
